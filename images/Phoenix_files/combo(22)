YUI.add("hermes-template-vr-overlay",(function(e,a){var r=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,a,r,t,s){return'<a class="close"><span></span></a>'},useData:!0}),t={};e.Array.each([],(function(a){var r=e.Template.get("hermes/"+a);r&&(t[a]=r)})),e.Template.register("hermes/vr-overlay",(function(a,s){return(s=s||{}).partials=s.partials?e.merge(t,s.partials):t,r(a,s)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-flickr-balls",(function(e,a){var l=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,a,l,r,s){return'<div class="balls">\n\t<div class="blue ball"></div><div class="pink ball"></div>\n</div>'},useData:!0}),r={};e.Array.each([],(function(a){var l=e.Template.get("hermes/"+a);l&&(r[a]=l)})),e.Template.register("hermes/flickr-balls",(function(a,s){return(s=s||{}).partials=s.partials?e.merge(r,s.partials):r,l(a,s)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("flickr-photos-removeTag-deletor",(function(o,e){"use strict";o.namespace("ModelDeletors")["flickr-photos-removeTag"]={run:function(r,t){var i={};return"string"==typeof r?i.tag_id=r:"object"==typeof r&&(i.global_tag_ids=r.globalTagIds.join(","),i.photo_ids=r.photoIds.join(",")),t.callAPI("flickr.photos.removeTag",i).then(null,o.FetcherErrorLogger(e))}}}),"@VERSION@",{requires:["flickr-promise"],optional:[]});YUI.add("tag-models",(function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{create:function(e){return t.ModelCreators["flickr-photos-addTags"].run(e,this.appContext)},delete:function(e){return t.ModelDeletors["flickr-photos-removeTag"].run(e,this.appContext)}},attributes:{tagValue:{validator:function(e){return t.AttributeHelpers.validateString(e)},setter:function(e){return t.AttributeHelpers.coerceString(e.trim().replace(/\s/g,""))}},tagRaw:{validator:function(e){return t.AttributeHelpers.validateString(e)},setter:function(e){return t.AttributeHelpers.coerceString(e)}},tagAuthorNSID:{},isMachineTag:{validator:function(e){return t.AttributeHelpers.validateBoolean(e)},setter:function(e){return t.AttributeHelpers.coerceBoolean(e)},defaultValue:!1},url:{derivedBy:["tagValue"],readOnly:!0,defaultFn:function(t){var e=this.getValue(t,"tagValue");return e?"/photos/tags/"+e:void 0}},searchUrl:{derivedBy:["tagValue","tagRaw","isMachineTag"],readOnly:!0,defaultFn:function(t){var e,r=this.getValue(t,"tagRaw"),a=this.getValue(t,"tagValue"),i=this.getValue(t,"isMachineTag");return r&&i?(r.indexOf(" ")>0&&(e=r.indexOf("=")+1,r=r.substring(0,e)+'"'+r.substring(e)+'"'),"/search/?tags="+r):a?"/search/?tags="+a:void 0}},duplicateAutotagId:{validator:function(e){return t.AttributeHelpers.validateString(e)},setter:function(e){return t.AttributeHelpers.coerceString(e)}}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-photos-addTags-creator","flickr-photos-removeTag-deletor"]});YUI.add("flickr-tags-getListPhoto-fetcher",(function(t,o){"use strict";t.namespace("ModelFetchers")["flickr-tags-getListPhoto"]={run:function(a,e){var s=a.id,g={photo_id:s,extras:"autotags",lang:e.lang},r=this;return t.Promise.all([e.callAPI("flickr.tags.getListPhoto",g),e.getModelRegistry("photo-tags-models"),e.getModelRegistry("tag-models"),e.getModelRegistry("photo-autotags-models"),e.getModelRegistry("autotag-models")]).then((function(t){return r._processResponse(t,s,e.flipper,e)}),t.FetcherErrorLogger(o))},_processResponse:function(o,a,e,s){var g,r=o[0],i=o[1],n=o[2],p=r.photo&&r.photo.tags&&void 0!==r.photo.tags.tag?r.photo.tags.tag.length:0,u=[],d=o[3],h=o[4],l=0,c=[];return p>0&&t.Array.each(r.photo.tags.tag,(function(t){"string"==typeof t.content&&u.push(n.addOrUpdate({id:t.id,tagRaw:t.raw,tagValue:t.content,tagAuthorNSID:t.author,isMachineTag:t.machineTag,duplicateAutotagId:t.duplicateAutotag}))})),i.exists(a)?i.setValue(a,"tags",u):i.add({id:a,tags:u}),g={id:a},r.photo&&r.photo.autotags&&void 0!==r.photo.autotags.autotag&&(l=r.photo.autotags.autotag.length),l>0&&t.Array.each(r.photo.autotags.autotag,(function(t){"string"==typeof t.content&&c.push(h.addOrUpdate({id:t.id,autotagValue:t.content,score:t.confidence,isPrivate:t.private}))})),g.autotags={page:1,perPage:1e3,pageContent:c,totalItems:l},d.exists(a)?d.setValue(a,"autotags",g.autotags):d.add(g),i.proxy(a)}}}),"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["tag-models","photo-tags-models"]});YUI.add("photo-tags-models",(function(t){function e(t){e.superclass.constructor.call(this,t)}t.Models[this.name]=e,t.extend(e,t.FlickrModelRegistry,{name:this.name,remote:{read:function(e){return t.ModelFetchers["flickr-tags-getListPhoto"].run(e,this.appContext)},create:function(e){return t.ModelCreators["flickr-photos-addTags"].run(e,this.appContext)},delete:function(e){return t.ModelDeletors["flickr-photos-removeTag"].run(e,this.appContext)}},attributes:{tags:{isCollection:!0}}})}),"@VERSION@",{requires:["flickr-model-registry","flickr-tags-getListPhoto-fetcher","flickr-photos-addTags-creator","flickr-photos-removeTag-deletor"]});YUI.add("flickr-photos-addTags-creator",(function(t,o){"use strict";t.namespace("ModelCreators")["flickr-photos-addTags"]={run:function(s,e){var r=this;return t.Promise.all([e.callAPI("flickr.photos.addTags",this._processParams(s)),e.getModelRegistry("photo-tags-models"),e.getModelRegistry("tag-models")]).then((function(t){return r._processResponse(t,s)}),(function(t){throw s.fullResponse&&(t.photoIds=s.photoId),t})).then(null,t.FetcherErrorLogger(o))},_processParams:function(t){t.tags=t.tags||[];var o={};return o.photo_ids=t.photoId.join(","),o.tags=t.tags.join(","),t.fullResponse&&(o.full_response=1),o.extras="is_autotag",o},_processResponse:function(t,o){var s,e,r,a=t[0],n=t[1],i=t[2],d=[];if(s=a.errors,!o.fullResponse){for(a.tags.tag.forEach((function(t){i.exists(t.id)||i.add({id:t.id,tagRaw:t.raw,tagValue:t.content.replace(/\s/g,""),tagAuthorNSID:t.author,duplicateAutotagId:t.duplicateAutotag}),d.push(i.proxy(t.id))})),e=0;e<o.photoId.length;e++)r=o.photoId[e],n.exists(r)?d.forEach((function(t){void 0!==t&&n.getValue(r,"tags").push(t)})):n.add({id:r,tags:d});return d}if(s&&s.length>0)return s}}}),"@VERSION@",{requires:["flickr-promise"],optional:["photo-tags-models","tag-models"]});YUI.add("flickr-favorites-getContext-fetcher",(function(e,o){"use strict";e.namespace("ListFetchers")["flickr-favorites-getContext"]={run:function(t,s){var r=this;return e.Promise.all([s.callAPI("flickr.favorites.getContext",this._processParams(t),!0),s.getModelRegistry("favorite-models"),s.getModelRegistry("photo-models"),s.getModelRegistry("person-models"),s.getModelRegistry("photo-engagement-models"),s.getModelRegistry("photo-stats-models")]).then((function(e){return r._processResponse(e,t)}),(function(e){throw 3===e.code&&"Photo not a favorite"===e.message&&(e.notInContext=!0),e})).then(null,e.FetcherErrorLogger(o))},_processParams:function(o){var t={photo_id:o.photoId,num_prev:o.numNext,num_next:o.numPrev,extras:e.APIHelper.request.getRebootPhotoExtras()};return o.id?t.user_id=o.id:t.path_alias=o.pathAlias,t},_processResponse:function(o,t){var s,r,n,a,p,i,l,h,d=o[0],g=o[1],u=o[2],m=o[3],c=o[4],x=o[5],y=[],M=u.proxy(t.photoId);return r=d.prevphotos,n=d.nextphotos,s=e.APIHelper.response.parsePhotos({photos:r.photo,personModelRegistry:m,photoModelRegistry:u,photoEngagementModelRegistry:c,photoStatsModelRegistry:x}),y=e.APIHelper.response.parsePhotos({photos:n.photo,personModelRegistry:m,photoModelRegistry:u,photoEngagementModelRegistry:c,photoStatsModelRegistry:x}),p=!!(l=g.getValue(t.id,"photoContextList")).hasMinBoundary&&l.hasMinBoundary(),i=!!l.hasMaxBoundary&&l.hasMaxBoundary(),a=l.getList(),h=e.APIHelper.response.addOrReplaceListByContext({model:M,next:s,prev:y.reverse(),hasMax:i,hasMin:p,current:a,numNext:t.numNext,numPrev:t.numPrev}),g.setValue(t.id,"photoContextList",h),{next:s,previous:y.reverse()}}}}),"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["favorite-models","photo-models","person-models","photo-engagement-models","photo-stats-models"]});