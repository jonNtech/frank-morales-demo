YUI.add("matrix-math",(function(t){t.MatrixMath={iterate:function(r,n,i,e){var u,a,l=[],f=r.length,c=r[0].length;for(u=0;u<f;u++)if(l[u]=[],c)for(a=0;a<c;a++)t.Lang.isArray(n)?l[u][a]=i.call(e,r[u][a],n[u][a]):l[u][a]=i.call(e,r[u][a],n);else t.Lang.isArray(n)?l[u]=i.call(e,r[u],n[u]):l[u]=i.call(e,r[u],n);return l},add:function(t,r){return this.iterate(t,r,(function(t,r){return t+r}),this)},subtract:function(t,r){return this.iterate(t,r,(function(t,r){return t-r}),this)},divide:function(t,r){return this.iterate(t,r,(function(t,r){return t/r}))},multiply:function(t,r){return this.iterate(t,r,(function(t,r){return t*r}))},realMultiply:function(t,r){var n,i,e,u=[],a=t.length,l=t[0].length;for(n=0;n<a;n++)for(u[n]=[],i=0;i<l;i++)for(e=0;e<l;e++)u[n][i]+=t[n][e]*r[n][i];return u},equality:function(t,r){var n=!0;if(t.length!==r.length)return!1;try{this.iterate(t,r,(function(t,r){if(t!==r)return n=!1,0}))}catch(t){n=!1}return n}}}),"@VERSION@",{requires:[],optional:[]});YUI.add("mrpinchy",(function(t){var n=/matrix3d\(([^\)]+)\)/,o=t.MatrixMath;function i(t){var n=t.length,o=0,i=0,e=0;for(e=0;e<n;e++)i+=t[e].pageY,o+=t[e].pageX;return[o/n,i/n]}function e(e){var r,a,s,u,h,c,f,m=e.node,l=e.maxScale||10,p=e.minScale||.5,g=m.one(".img"),d=g.get("offsetWidth"),b=g.get("offsetHeight"),y=g.getXY(),v=1,w=[0,0],M=0,S=[0,0],k=1,z=0,x=!1,I=0,Y=0,X=new t.EventTarget,D="transform 0.25s ease-out",B=m.getStyle("transform");function H(){m&&(m.setStyles({"-webkit-transition":"-webkit-"+D,"-moz-transition":"-moz-"+D,"-o-transition":"-o-"+D,"-ms-transition":"-ms-"+D,transition:D}),P([[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,1,1]],!0),m.setStyle("transform",B)),k=1,v=1}u=e.boundingBox?e.boundingBox:[[0,0],[window.innerWidth,window.innerHeight]],m&&m.setStyles({"-webkit-transform-origin":"0 0","-moz-transform-origin":"0 0","-o-transform-origin":"0 0","-ms-transform-origin":"0 0","transform-origin":"0 0"}),f=m,m&&m.on("webkitTransitionEnd",(function(){f.setStyles({"-webkit-transition":"","-moz-transition":"","-o-transition":"","-ms-transition":"",transition:""})}));var T={touchstart:function(t){if(P(O()),S=i(t.touches),w=S,S,z=1===t.touches.length?Date.now():0,2===t.touches.length){var n=Math.abs(t.touches[0].pageX-t.touches[1].pageX),o=Math.abs(t.touches[0].pageY-t.touches[1].pageY);a=Math.sqrt(n*n+o*o)}},touchmove:function(t){S=i(t.touches),M||1!==t.touches.length?2===t.touches.length&&(z=0,(function(t){if(2===t.touches.length){M||X.fire("mrpinchy:startpinch"),M=1;var n=t.scale;n||(n=(function(t){if(t.touches&&t.touches.length>1){var n=Math.abs(t.touches[0].pageX-t.touches[1].pageX),o=Math.abs(t.touches[0].pageY-t.touches[1].pageY);return Math.sqrt(n*n+o*o)/a}return 1})(t)),E(n,i(t.touches))}})(t)):1!==v&&(function(t){var n,i,e,r,a,s={top:0,right:0,bottom:0,left:0},h={top:0,right:0,bottom:0,left:0};if(!w)return;var f=S[0]-w[0],m=S[1]-w[1];u&&(n=j(),e=[d,b],i=o.multiply(e,v),r=o.add(n,i),a=o.divide(i,2),a=o.add(a,n),n[1]<u[0][1]&&(h.top=1),n[0]<u[0][0]&&(h.left=1),r[0]>u[1][0]&&(h.right=1),r[1]>u[1][1]&&(h.bottom=1));var l=O();if(h.left||h.right||!u){var p=parseInt(l[3][0],10)+Math.round(f);p&&(l[3][0]=p)}(h.bottom||h.top||!u)&&(l[3][1]=parseInt(l[3][1],10)+Math.round(m));P(l),w=S,c=null,n[1]>u[0][1]&&h.bottom&&(s.bottom=1);r[1]<u[1][1]&&h.top&&(s.top=1);n[0]>u[0][0]&&h.right&&(s.right=1);r[0]<u[1][0]&&h.left&&(s.left=1);s.bottom&&s.right?c=o.subtract(u[0],y):s.bottom&&s.left?c=o.subtract([u[1][0],u[0][1]],[Math.round((y[0]+d)*v),y[1]]):s.top&&s.right?c=[u[0][0]-y[0],u[1][1]-(y[1]+i[1])]:s.top&&s.left?c=[u[1][0]-(y[0]+i[0]),u[1][1]-(y[1]+i[1])]:s.right?c=[u[0][0]-y[0],parseInt(l[3][1],10)+Math.round(m)]:s.left?c=[Math.round(u[1][0]-y[0]-i[0]),parseInt(l[3][1],10)+Math.round(m)]:s.bottom?c=[parseInt(l[3][0],10)+Math.round(f),Math.round(u[0][1]-y[1])]:s.top&&(c=[parseInt(l[3][0],10)+Math.round(f),u[1][1]-(y[1]+i[1])])})(),R()},touchend:function(n){var o,i;n.touches.length<1&&1!==v?(k=v,z?(Date.now()-z<100&&(!(function(n){I++,s&&s.cancel(),Date.now()-Y>180?(I=1,s=t.later(200,this,(function(){X.fire("mrpinchy:singletap",n)}))):2===I&&(H(),I=0,X.fire("mrpinchy:doubletap"),X.fire("mrpinchy:reset")),Y=Date.now()})(n),z=0),z=0,c&&(m.setStyles({"-webkit-transition":"-webkit-"+D,"-moz-transition":"-moz-"+D,"-o-transition":"-o-"+D,"-ms-transition":"-ms-"+D,transition:D}),N(c),R(),c=null),X.fire("mrpinchy:endmove")):k>l?(q(l,!0),N(h.translate),v=l,k=l,m.setStyles({"-webkit-transition":"-webkit-"+D,"-moz-transition":"-moz-"+D,"-o-transition":"-o-"+D,"-ms-transition":"-ms-"+D,transition:D}),R(),h=null):k<p&&(q(p,!0),N([0,0]),v=p,k=p,m.setStyles({"-webkit-transition":"-webkit-"+D,"-moz-transition":"-moz-"+D,"-o-transition":"-o-"+D,"-ms-transition":"-ms-"+D,transition:D}),R(),X.fire("mrpinchy:reset",k),H(),h=null),X.fire("mrpinchy:endpinch",k),M=0,o=O(),(i=[]).push([o[0][0],o[0][1]]),i.push([o[1][0],o[1][1]]),i.push([o[3][0],o[3][1]]),m&&m.setStyle("transform","matrix( "+i.join(",")+")")):1===v&&X.fire("mrpinchy:endpinch",1)}};function q(t,n){var o,i=O();o=n?t:k*t,i[0][0]=o,i[1][1]=o,P(i,!0),v=o}function E(t,n,i){var e,r,a,s,u,c,f,m=k*t;e=j(),r=[n[0]-e[0],n[1]-e[1]],a=[d,b],s=o.multiply(a,v),u=o.multiply(a,m),c=o.subtract(u,s),N([(f=o.multiply(o.divide(r,u),c))[0],-f[1]],!0),q(t),(m>l&&!h||m<p&&!h)&&(h={scale:t,translate:[O()[3][0],O()[3][1]]})}function W(t){x||(t.preventDefault(),T[t.type](t))}function j(){return m.getXY()}function N(t,n){var o=O();n?(o[3][0]-=t[0],o[3][1]+=t[1]):(o[3][0]=t[0],o[3][1]=t[1]),P(o)}function O(){var t,o=[],i=[];if(r)return r;if(!(t=m.getStyle("transform")).match(n))return P([[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,1,1]],!0),r;i=t.match(n)[1].replace(/\s/g,"").split(",");for(var e,a=0,s=0;s<4;s++){e=[];for(var u=0;u<4;u++)e.push(i[a++]);o.push(e)}return r=o,o}function P(t,n){t&&4===t.length&&(r=t,n&&R())}function R(){var t=r;t&&m&&m.setStyle("transform","matrix3d("+t.join(",")+")")}return X.getTouchHandler=function(){return W},X.destroy=function(){m=null,x=!0},X.updateBoundingBox=function(t){u=t},X.updateImageSize=function(){d=g.get("offsetWidth"),b=g.get("offsetHeight")},X.resetTransform=function(){H()},X}t.MrPinchy={init:function(t){return new e(t)}}}),"@VERSION@",{requires:["matrix-math"],optional:[]});YUI.add("mobile-photo-well-view",(function(e){e.namespace("Views")[this.name]=e.Base.create("mobile-photo-well-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){this.photoId=t.photoId,this.context=e.clone(t.context,!0);var o=this.appContext.getUA().os;if(this.nsid=t.nsid,this.disablePinchZooming="windows"===o,this.isAndroid="android"===o,this.context&&this.context.params&&this.context.params.isSharedEntity){var i=this.context.params;this.appContext.setGPCredentials({gp_code:i.gpCode,gp_owner:i.gpOwner,share_code:i.gpCode})}else this.appContext.setGPCredentials(null);return this},loadState:function(){var t=this,o=[];return o.push(this.appContext.getModel("photo-models",this.photoId).then((function(o){if(t.set("photoModel",o),o.getValue("isVideo"))return new e.Promise((function(t,o){e.use("flickr-video-player",(function(){t()}))}))}))),e.Promise.all(o)},buildContainer:function(){var t,o,i,n,s,a,r=this.get("photoModel"),l=r.getValue("isVideo");if(YUI.Env.isServer)i=(t=500)/8,n=(o=500)/8;else{t=parseInt(e.StorageHelper.getItem("mobile-photo-well-width"),10),o=parseInt(e.StorageHelper.getItem("mobile-photo-well-height"),10);var h=this.getUsableAreaSize(),d=h.actualW,p=h.adjustedH;(!t||isNaN(t)||t<50)&&(t=d),(!o||isNaN(o)||o<50)&&(o=p),i=t,n=o}var u=r.getSizeToFit({width:i,height:n},{cropToFit:!0});return this.set("bestImageSize",u),s=Math.max(u.height/3,o),a=u.height/u.width,this.setContainerWithTemplate("mobile-photo-well",{maxHeight:s,isServer:YUI.Env.isServer,loadAspect:a,loadHeight:a*t,url:u.url,isVideo:l,needsInterstitial:r.getValue("needsInterstitial"),isSignedIn:this.appContext.getViewer().signedIn,isMinor:this.appContext.getViewer().isMinor}),this},activate:function(){var t=this.get("container"),o=t.one(".main-image"),i=t.one(".main-image-wrapper"),n=this.get("photoModel"),s=this.get("photoModel").getValue("isVideo"),a=this;t.all(".photo-link.loading").removeClass("loading"),o.setStyle("width",null),i.setStyle("height",null),this.findBestPhoto(n,o),this.appContext.getViewCounter().queue(this.get("photoModel").getValue("id"),this.appContext.getReferrer()),this.loadAdjacentPhotos();var r=parseInt(i.getComputedStyle("height"),10);return this.get("container").setStyle("height",r+"px"),i.setStyle("position","absolute"),!s||n.getValue("isVideoPending")||n.getValue("isVideoFailed")||(a.player=new e.FlickrVideoPlayer({container:t.one(".videoplayer"),model:n,appContext:a.appContext,videoNode:t.one("#video_1")?t.one("#video_1")._node:null}),a.player.init(),a.on("destroy",(function(){a.player&&(a.player.destroy(),a.player=null)}))),s||this.disablePinchZooming||this.addPinchy(),window.orientation&&this.registerEventHandler(e.on("orientationchange",(function(e){var t=window.innerWidth,o=window.innerHeight,i=t>o,n=[[0,0],[i?o:t,i?t:o]];a.transform.updateBoundingBox(n),a.transform.updateImageSize()}))),this.context&&this.context.modelName&&this.context.params&&this.appContext.getModel(this.context.modelName,this.context.params).then((function(e){if(e)return a.set("contextModel",e),e.getValue("photoContextList").getContext({photoId:a.photoId}).then((function(){var t=-1,o=e.getValue("photoContextList").getList();if(o.some((function(e,o){return e.id===a.photoId&&(t=o),t>0})),t>-1){var i,n,s,r,l="/in/"+e.getValue("urlSuffix");t>0&&(i=o[t-1])&&(s=i.getValue("url")+l),t<o.length-1&&(n=o[t+1])&&(r=n.getValue("url")+l),s&&a.get("container").one(".prev-photo").setAttribute("href",s).removeClass("hide-nav-link"),r&&a.get("container").one(".next-photo").setAttribute("href",r).removeClass("hide-nav-link")}}))})),this},addPinchy:function(){var t,o=window.innerWidth,i=window.innerHeight,n=o>i,s=this.get("container").one(".main-image-wrapper"),a=this.get("container").one(".main-image-wrapper-underlay"),r=[[0,0],[n?i:o,n?o:i]],l=this;this.transform=e.MrPinchy.init({node:s,maxScale:n?2:3,minScale:1,boundingBox:r}),t=this.transform.getTouchHandler(),this.largeLoaded=!1,s.on("touchstart",(function(o){t(o),1!==o.touches.length&&(l.largeLoaded||(l.largeLoaded=!0,l.findBestPhoto(l.get("photoModel"),s.one(".img"),!0,!0)),l.addZoomTimeout=setTimeout((function(){l.get("container").addClass("zoomed"),s.addClass("zoomed"),e.one("html").setStyle("position","fixed"),a.setStyle("display","block"),setTimeout((function(){a.addClass("show-overlay")}),10)}),200))})),s.on("touchmove",t),s.on("touchend",t),s.on("touchcancel",(function(e){l.transform.resetTransform(),l.transform.fire("mrpinchy:reset")})),this.transform.on("mrpinchy:reset",(function(){clearTimeout(l.addZoomTimeout),l.get("container").removeClass("zoomed"),s.removeClass("zoomed"),e.one("html").setStyle("position",null),a.removeClass("show-overlay"),setTimeout((function(){a.setStyle("display","none")}),800)})),this.transform.on("mrpinchy:endpinch",(function(t){1===t&&(clearTimeout(l.addZoomTimeout),l.get("container").removeClass("zoomed"),s.removeClass("zoomed"),e.one("html").setStyle("position",null),a.removeClass("show-overlay"),setTimeout((function(){a.setStyle("display","none")}),800))}))},getUsableAreaSize:function(){var e=window.innerWidth,t=window.innerHeight;return{actualW:e,actualH:t,adjustedH:t-50-50}},findBestPhoto:function(t,o,i,n){var s=this.getUsableAreaSize(),a=s.actualW,r=s.adjustedH,l=t.getSizeToFit({width:i?3*a:a,height:i?3*r:r},{cropToFit:!0});(r=Math.min(a/l.width*l.height,s.adjustedH),o)?(o.getAttribute("src")!==l.url&&o.setAttribute("src",l.url),this.set("bestImageSize",l),o.setStyle("height",r),this.get("container").setStyle("height",r),YUI.Env.isServer||(e.StorageHelper.setItem("mobile-photo-well-width",a),e.StorageHelper.setItem("mobile-photo-well-height",s.adjustedH))):(new Image).src=l.url},loadAdjacentPhotos:function(){var e=this.get("prevPhoto"),t=this.get("nextPhoto");t&&this.findBestPhoto(t),e&&this.findBestPhoto(e)}})}),"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-mobile-photo-well","viewport-data","storage-helper","mrpinchy"],langBundles:["common","photo-page-scrappy"]});YUI.add("hermes-template-sub-photo",(function(t,e){var n=t.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(t,e,n,l,o){var a=null!=e?e:t.nullContext||{},r=t.hooks.helperMissing,s=t.escapeExpression,u=t.lookupProperty||function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]};return'<div class="sub-photo-container centered-content">\n\t<div class="sub-photo-content-container">\n\t\t'+s((u(n,"outlet")||e&&u(e,"outlet")||r).call(a,null!=e?u(e,"sub-photo-left-view"):e,{name:"outlet",hash:{},data:o,loc:{start:{line:3,column:2},end:{line:3,column:32}}}))+"\n\t\t"+s((u(n,"outlet")||e&&u(e,"outlet")||r).call(a,null!=e?u(e,"sub-photo-right-view"):e,{name:"outlet",hash:{},data:o,loc:{start:{line:4,column:2},end:{line:4,column:33}}}))+"\n\t</div>\n\n\t\n\t"+s((u(n,"outlet")||e&&u(e,"outlet")||r).call(a,null!=e?u(e,"sub-photo-keyboard-shortcuts-view"):e,{name:"outlet",hash:{},data:o,loc:{start:{line:8,column:1},end:{line:8,column:45}}}))+"\n</div>\n"},useData:!0}),l={};t.Array.each([],(function(e){var n=t.Template.get("hermes/"+e);n&&(l[e]=n)})),t.Template.register("hermes/sub-photo",(function(e,o){return(o=o||{}).partials=o.partials?t.merge(l,o.partials):l,n(e,o)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-sub-photo-left",(function(e,l){var t=e.Template.Handlebars.revive({1:function(e,l,t,n,o){var a=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return"\t"+e.escapeExpression((a(t,"outlet")||l&&a(l,"outlet")||e.hooks.helperMissing).call(null!=l?l:e.nullContext||{},null!=l?a(l,"sub-photo-liked-by-view"):l,{name:"outlet",hash:{},data:o,loc:{start:{line:5,column:1},end:{line:5,column:35}}}))+"\n"},3:function(e,l,t,n,o){var a=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return"\t"+e.escapeExpression((a(t,"outlet")||l&&a(l,"outlet")||e.hooks.helperMissing).call(null!=l?l:e.nullContext||{},null!=l?a(l,"sub-photo-fave-view"):l,{name:"outlet",hash:{},data:o,loc:{start:{line:7,column:1},end:{line:7,column:31}}}))+"\n"},5:function(e,l,t,n,o){var a=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return"\t"+e.escapeExpression((a(t,"outlet")||l&&a(l,"outlet")||e.hooks.helperMissing).call(null!=l?l:e.nullContext||{},null!=l?a(l,"photo-comments-view"):l,{name:"outlet",hash:{},data:o,loc:{start:{line:11,column:1},end:{line:11,column:31}}}))+"\n"},7:function(e,l,t,n,o){var a=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return"\t"+e.escapeExpression((a(t,"outlet")||l&&a(l,"outlet")||e.hooks.helperMissing).call(null!=l?l:e.nullContext||{},null!=l?a(l,"sub-photo-comments-view"):l,{name:"outlet",hash:{},data:o,loc:{start:{line:13,column:1},end:{line:13,column:35}}}))+"\n"},compiler:[8,">= 4.3.0"],main:function(e,l,t,n,o){var a,r=null!=l?l:e.nullContext||{},u=e.hooks.helperMissing,i=e.escapeExpression,s=e.lookupProperty||function(e,l){if(Object.prototype.hasOwnProperty.call(e,l))return e[l]};return i((s(t,"outlet")||l&&s(l,"outlet")||u).call(r,null!=l?s(l,"attribution-view"):l,{name:"outlet",hash:{},data:o,loc:{start:{line:1,column:0},end:{line:1,column:27}}}))+"\n"+i((s(t,"outlet")||l&&s(l,"outlet")||u).call(r,null!=l?s(l,"sub-photo-title-desc-view"):l,{name:"outlet",hash:{},data:o,loc:{start:{line:2,column:0},end:{line:2,column:36}}}))+"\n"+i((s(t,"outlet")||l&&s(l,"outlet")||u).call(r,null!=l?s(l,"gift-pro-view"):l,{name:"outlet",hash:{},data:o,loc:{start:{line:3,column:0},end:{line:3,column:24}}}))+"\n"+(null!=(a=(s(t,"isFlipped")||l&&s(l,"isFlipped")||u).call(r,"enable-likes",{name:"isFlipped",hash:{},fn:e.program(1,o,0),inverse:e.program(3,o,0),data:o,loc:{start:{line:4,column:0},end:{line:8,column:14}}}))?a:"")+"\n"+(null!=(a=(s(t,"isFlipped")||l&&s(l,"isFlipped")||u).call(r,"enable-photo-page-comments-component",{name:"isFlipped",hash:{},fn:e.program(5,o,0),inverse:e.program(7,o,0),data:o,loc:{start:{line:10,column:0},end:{line:14,column:14}}}))?a:"")},useData:!0}),n={};e.Array.each([],(function(l){var t=e.Template.get("hermes/"+l);t&&(n[l]=t)})),e.Template.register("hermes/sub-photo-left",(function(l,o){return(o=o||{}).partials=o.partials?e.merge(n,o.partials):n,t(l,o)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-attribution",(function(n,l){var a=n.Template.Handlebars.revive({1:function(n,l,a,e,t){var o,r=null!=l?l:n.nullContext||{},i=n.hooks.helperMissing,u="function",s=n.escapeExpression,c=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t<a class="avatar person medium no-menu" data-person-nsid="'+s(typeof(o=null!=(o=c(a,"nsid")||(null!=l?c(l,"nsid"):l))?o:i)===u?o.call(r,{name:"nsid",hash:{},data:t,loc:{start:{line:2,column:59},end:{line:2,column:67}}}):o)+'" style="background-image: url('+s(typeof(o=null!=(o=c(a,"buddyicon")||(null!=l?c(l,"buddyicon"):l))?o:i)===u?o.call(r,{name:"buddyicon",hash:{},data:t,loc:{start:{line:2,column:98},end:{line:2,column:111}}}):o)+');" href="/photos/'+s(typeof(o=null!=(o=c(a,"pathAlias")||(null!=l?c(l,"pathAlias"):l))?o:i)===u?o.call(r,{name:"pathAlias",hash:{},data:t,loc:{start:{line:2,column:129},end:{line:2,column:142}}}):o)+'/"></a>\n'},3:function(n,l,a,e,t){var o,r=null!=l?l:n.nullContext||{},i=n.hooks.helperMissing,u="function",s=n.escapeExpression,c=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t<a class="avatar person medium"\n\t\thref="/photos/'+s(typeof(o=null!=(o=c(a,"pathAlias")||(null!=l?c(l,"pathAlias"):l))?o:i)===u?o.call(r,{name:"pathAlias",hash:{},data:t,loc:{start:{line:5,column:16},end:{line:5,column:29}}}):o)+'/"\n\t\tdata-person-nsid="'+s(typeof(o=null!=(o=c(a,"nsid")||(null!=l?c(l,"nsid"):l))?o:i)===u?o.call(r,{name:"nsid",hash:{},data:t,loc:{start:{line:6,column:20},end:{line:6,column:28}}}):o)+'"\n\t\tstyle="background-image: url('+s(typeof(o=null!=(o=c(a,"buddyicon")||(null!=l?c(l,"buddyicon"):l))?o:i)===u?o.call(r,{name:"buddyicon",hash:{},data:t,loc:{start:{line:7,column:31},end:{line:7,column:44}}}):o)+');"\n\t\ttabindex="0"></a>\n'},5:function(n,l,a,e,t){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(o=r(a,"if").call(null!=l?l:n.nullContext||{},null!=l?r(l,"isPro"):l,{name:"if",hash:{},fn:n.program(6,t,0),inverse:n.noop,data:t,loc:{start:{line:12,column:1},end:{line:18,column:8}}}))?o:""},6:function(n,l,a,e,t){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(o=r(a,"if").call(null!=l?l:n.nullContext||{},null!=l?r(l,"realFullscreenEnabled"):l,{name:"if",hash:{},fn:n.program(7,t,0),inverse:n.program(9,t,0),data:t,loc:{start:{line:13,column:2},end:{line:17,column:9}}}))?o:""},7:function(n,l,a,e,t){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(o=n.invokePartial(r(e,"pro-badge"),l,{name:"pro-badge",hash:{purchaseProURL:null!=l?r(l,"upgradeProLink"):l,light:!0,badgeType:null!=l?r(l,"proBadge"):l},data:t,indent:"\t\t\t",helpers:a,partials:e,decorators:n.decorators}))?o:""},9:function(n,l,a,e,t){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(o=n.invokePartial(r(e,"pro-badge"),l,{name:"pro-badge",hash:{purchaseProURL:null!=l?r(l,"upgradeProLink"):l,badgeType:null!=l?r(l,"proBadge"):l},data:t,indent:"\t\t\t",helpers:a,partials:e,decorators:n.decorators}))?o:""},11:function(n,l,a,e,t){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(o=r(a,"if").call(null!=l?l:n.nullContext||{},null!=l?r(l,"isPro"):l,{name:"if",hash:{},fn:n.program(7,t,0),inverse:n.noop,data:t,loc:{start:{line:29,column:2},end:{line:31,column:9}}}))?o:""},compiler:[8,">= 4.3.0"],main:function(n,l,a,e,t){var o,r,i=null!=l?l:n.nullContext||{},u=n.hooks.helperMissing,s="function",c=n.escapeExpression,p=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return(null!=(o=p(a,"if").call(i,null!=l?p(l,"noMenu"):l,{name:"if",hash:{},fn:n.program(1,t,0),inverse:n.program(3,t,0),data:t,loc:{start:{line:1,column:0},end:{line:9,column:7}}}))?o:"")+"\n"+(null!=(o=p(a,"unless").call(i,null!=l?p(l,"isAlbumView"):l,{name:"unless",hash:{},fn:n.program(5,t,0),inverse:n.noop,data:t,loc:{start:{line:11,column:0},end:{line:19,column:11}}}))?o:"")+'\n<div class="attribution-info">\n\n\t<a href="/photos/'+c(typeof(r=null!=(r=p(a,"pathAlias")||(null!=l?p(l,"pathAlias"):l))?r:u)===s?r.call(i,{name:"pathAlias",hash:{},data:t,loc:{start:{line:23,column:18},end:{line:23,column:31}}}):r)+'/" class="owner-name truncate" title="'+c((p(a,"intlMessage")||l&&p(l,"intlMessage")||u).call(i,{name:"intlMessage",hash:{name:null!=l?p(l,"displayname"):l,intlName:"attribution.GO_TO_PHOTOSTREAM"},data:t,loc:{start:{line:23,column:69},end:{line:23,column:142}}}))+'" data-track="attributionNameClick">'+c(typeof(r=null!=(r=p(a,"displayname")||(null!=l?p(l,"displayname"):l))?r:u)===s?r.call(i,{name:"displayname",hash:{},data:t,loc:{start:{line:23,column:178},end:{line:23,column:193}}}):r)+'</a>\n\t<a href="/photos/'+c(typeof(r=null!=(r=p(a,"pathAlias")||(null!=l?p(l,"pathAlias"):l))?r:u)===s?r.call(i,{name:"pathAlias",hash:{},data:t,loc:{start:{line:24,column:18},end:{line:24,column:31}}}):r)+'/" class="owner-name-with-by truncate" title="'+c((p(a,"intlMessage")||l&&p(l,"intlMessage")||u).call(i,{name:"intlMessage",hash:{name:null!=l?p(l,"displayname"):l,intlName:"attribution.GO_TO_PHOTOSTREAM"},data:t,loc:{start:{line:24,column:77},end:{line:24,column:150}}}))+'" data-track="attributionNameClick">'+c((p(a,"intlMessage")||l&&p(l,"intlMessage")||u).call(i,{name:"intlMessage",hash:{user:null!=l?p(l,"displayname"):l,intlName:"attribution.BY_USER"},data:t,loc:{start:{line:24,column:186},end:{line:24,column:249}}}))+"</a>\n\n\t"+c((p(a,"outlet")||l&&p(l,"outlet")||u).call(i,null!=l?p(l,"follow-view"):l,{name:"outlet",hash:{},data:t,loc:{start:{line:26,column:1},end:{line:26,column:23}}}))+"\n\n"+(null!=(o=p(a,"if").call(i,null!=l?p(l,"isAlbumView"):l,{name:"if",hash:{},fn:n.program(11,t,0),inverse:n.noop,data:t,loc:{start:{line:28,column:1},end:{line:32,column:8}}}))?o:"")+"\n</div>\n"},usePartial:!0,useData:!0}),e={};n.Array.each(["pro-badge","pro-badge","pro-badge"],(function(l){var a=n.Template.get("hermes/"+l);a&&(e[l]=a)})),n.Template.register("hermes/attribution",(function(l,t){return(t=t||{}).partials=t.partials?n.merge(e,t.partials):e,a(l,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base","hermes-template-pro-badge","hermes-template-pro-badge","hermes-template-pro-badge"]});YUI.add("attribution-view",(function(e){var i=new e.SubscriptionsHelper;e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,subviewConfig:{"follow-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!1,disabled:function(){return this.hideFollowView}}},initializer:function(e){return this.nsid=e.nsid,this.albumPhotoListLayoutStyle=e.albumPhotoListLayoutStyle,this.realFullscreen=!!e.realFullscreen,this.hideFollowView=!!e.hideFollowView&&e.hideFollowView,this.isAlbumView=e.isAlbumView,this},loadState:function(){var e=this;return this.appContext.getModel("person-models",this.nsid).then((function(i){e.set("owner",i)}))},buildContainer:function(){var e,t=this.get("owner"),l=this.get("container"),n=t.getValue("pathAlias")||t.getValue("nsid");return"justified"===this.albumPhotoListLayoutStyle&&l.addClass("justified-album-details-page"),e=t.getValue("buddyicon").large?t.getValue("buddyicon").large:t.getValue("buddyicon").default,this.setContainerWithTemplate("attribution",{isPro:t.getValue("isPro"),proBadge:t.getValue("proBadge"),pathAlias:n,buddyicon:e,nsid:t.getValue("nsid"),displayname:t.getValue("displayname"),realFullscreenEnabled:this.realFullscreen&&this.appContext.experiments.fullscreen.getMode(),isAlbumView:this.isAlbumView,upgradeProLink:i.getProLandingPageUrl(i.UTM_PRO_BADGE,{utm_medium:this.name})}),this},activate:function(){return this}})}),"@VERSION@",{requires:["flickr-view","hermes-template-attribution","promise","follow-view","subscriptions-helper"],optional:["person-models"],langBundles:["attribution","common"]});YUI.add("hermes-template-sub-photo-title-desc",(function(n,l){var e=n.Template.Handlebars.revive({1:function(n,l,e,t,a){var o,i=null!=l?l:n.nullContext||{},r=n.hooks.helperMissing,s=n.escapeExpression,u=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\n"+(null!=(o=u(e,"if").call(i,null!=l?u(l,"showEditIcon"):l,{name:"if",hash:{},fn:n.program(2,a,0),inverse:n.noop,data:a,loc:{start:{line:3,column:1},end:{line:5,column:8}}}))?o:"")+'\n\t<div class="title-desc-block '+(null!=(o=u(e,"if").call(i,null!=l?u(l,"isOwner"):l,{name:"if",hash:{},fn:n.program(4,a,0),inverse:n.noop,data:a,loc:{start:{line:7,column:30},end:{line:7,column:60}}}))?o:"")+" "+(null!=(o=u(e,"unless").call(i,null!=l?u(l,"enableCollapsableTitleAndDescription"):l,{name:"unless",hash:{},fn:n.program(6,a,0),inverse:n.noop,data:a,loc:{start:{line:7,column:61},end:{line:7,column:128}}}))?o:"")+'" tabindex="0" aria-label="'+s((u(e,"intlMessage")||l&&u(l,"intlMessage")||r).call(i,{name:"intlMessage",hash:{intlName:"photo-page-scrappy.ENTER_TO_EDIT_TITLE_DESC"},data:a,loc:{start:{line:7,column:155},end:{line:7,column:225}}}))+'">\n'+(null!=(o=u(e,"unless").call(i,null!=l?u(l,"noTitleToDisplay"):l,{name:"unless",hash:{},fn:n.program(8,a,0),inverse:n.noop,data:a,loc:{start:{line:8,column:2},end:{line:21,column:13}}}))?o:"")+"\n"+(null!=(o=u(e,"unless").call(i,null!=l?u(l,"noDescToDisplay"):l,{name:"unless",hash:{},fn:n.program(18,a,0),inverse:n.noop,data:a,loc:{start:{line:23,column:2},end:{line:32,column:13}}}))?o:"")+'\n\t\t<button class="'+(null!=(o=u(e,"if").call(i,null!=l?u(l,"isMobile"):l,{name:"if",hash:{},fn:n.program(16,a,0),inverse:n.noop,data:a,loc:{start:{line:34,column:17},end:{line:34,column:54}}}))?o:"")+'ui-button ui-button-cta done-editing-title-desc" data-action="saveTitleDescEdit">'+s((u(e,"intlMessage")||l&&u(l,"intlMessage")||r).call(i,{name:"intlMessage",hash:{intlName:"common.DONE"},data:a,loc:{start:{line:34,column:135},end:{line:34,column:173}}}))+"</button>\n\n\t</div>\n\n"+(null!=(o=u(e,"if").call(i,null!=l?u(l,"enableCollapsableTitleAndDescription"):l,{name:"if",hash:{},fn:n.program(21,a,0),inverse:n.noop,data:a,loc:{start:{line:38,column:1},end:{line:42,column:8}}}))?o:"")+"\n"},2:function(n,l,e,t,a){return'\t\t<svg class="title-desc-edit mobile-edit-title-desc icon icon-edit"><use xlink:href="#icon-edit"></use></svg>\n'},4:function(n,l,e,t,a){return"editable"},6:function(n,l,e,t,a){return"showFull"},8:function(n,l,e,t,a){var o,i=null!=l?l:n.nullContext||{},r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t\t<h1 class="'+(null!=(o=r(e,"if").call(i,null!=l?r(l,"isOwner"):l,{name:"if",hash:{},fn:n.program(4,a,0),inverse:n.noop,data:a,loc:{start:{line:9,column:14},end:{line:9,column:44}}}))?o:"")+" meta-field photo-title "+(null!=(o=r(e,"if").call(i,null!=(o=null!=l?r(l,"empty"):l)?r(o,"title"):o,{name:"if",hash:{},fn:n.program(9,a,0),inverse:n.noop,data:a,loc:{start:{line:9,column:68},end:{line:9,column:110}}}))?o:"")+'">\n'+(null!=(o=r(e,"if").call(i,null!=l?r(l,"title"):l,{name:"if",hash:{},fn:n.program(11,a,0),inverse:n.noop,data:a,loc:{start:{line:10,column:4},end:{line:12,column:11}}}))?o:"")+"\t\t\t</h1>\n"+(null!=(o=r(e,"unless").call(i,null!=l?r(l,"isMobile"):l,{name:"unless",hash:{},fn:n.program(13,a,0),inverse:n.noop,data:a,loc:{start:{line:14,column:3},end:{line:16,column:14}}}))?o:"")+'\n\t\t\t<input type="text" class="'+(null!=(o=r(e,"if").call(i,null!=l?r(l,"isMobile"):l,{name:"if",hash:{},fn:n.program(16,a,0),inverse:n.noop,data:a,loc:{start:{line:18,column:29},end:{line:18,column:66}}}))?o:"")+'meta-field edit-meta-field edit-photo-title" wrap="on"></input>\n\t\t\t<input type="text" class="'+(null!=(o=r(e,"if").call(i,null!=l?r(l,"isMobile"):l,{name:"if",hash:{},fn:n.program(16,a,0),inverse:n.noop,data:a,loc:{start:{line:19,column:29},end:{line:19,column:66}}}))?o:"")+'meta-field edit-meta-field false-textarea false-edit-photo-title" wrap="on" tabindex="-1" aria-hidden="true"></input>\n\n'},9:function(n,l,e,t,a){return"placeholder-text"},11:function(n,l,e,t,a){var o,i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t\t\t\t"+n.escapeExpression("function"==typeof(o=null!=(o=i(e,"title")||(null!=l?i(l,"title"):l))?o:n.hooks.helperMissing)?o.call(null!=l?l:n.nullContext||{},{name:"title",hash:{},data:a,loc:{start:{line:11,column:5},end:{line:11,column:14}}}):o)+"\n"},13:function(n,l,e,t,a){var o,i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t\t\t"+(null!=(o=i(e,"if").call(null!=l?l:n.nullContext||{},null!=l?i(l,"isOwner"):l,{name:"if",hash:{},fn:n.program(14,a,0),inverse:n.noop,data:a,loc:{start:{line:15,column:4},end:{line:15,column:156}}}))?o:"")+"\n"},14:function(n,l,e,t,a){var o=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'<a href="#" class="title-desc-edit ui-icon-title-desc-edit" data-action="edit" title="'+n.escapeExpression((o(e,"intlMessage")||l&&o(l,"intlMessage")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},{name:"intlMessage",hash:{intlName:"common.EDIT"},data:a,loc:{start:{line:15,column:105},end:{line:15,column:143}}}))+'"></a>'},16:function(n,l,e,t,a){return"hide-editable "},18:function(n,l,e,t,a){var o,i=null!=l?l:n.nullContext||{},r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'\t\t\t<h2 class="'+(null!=(o=r(e,"if").call(i,null!=l?r(l,"isOwner"):l,{name:"if",hash:{},fn:n.program(4,a,0),inverse:n.noop,data:a,loc:{start:{line:24,column:14},end:{line:24,column:44}}}))?o:"")+" meta-field photo-desc "+(null!=(o=r(e,"if").call(i,null!=(o=null!=l?r(l,"empty"):l)?r(o,"desc"):o,{name:"if",hash:{},fn:n.program(9,a,0),inverse:n.noop,data:a,loc:{start:{line:24,column:67},end:{line:24,column:108}}}))?o:"")+'">\n'+(null!=(o=r(e,"if").call(i,null!=l?r(l,"description"):l,{name:"if",hash:{},fn:n.program(19,a,0),inverse:n.noop,data:a,loc:{start:{line:25,column:4},end:{line:27,column:11}}}))?o:"")+'\t\t\t</h2>\n\n\t\t\t<textarea class="'+(null!=(o=r(e,"if").call(i,null!=l?r(l,"isMobile"):l,{name:"if",hash:{},fn:n.program(16,a,0),inverse:n.noop,data:a,loc:{start:{line:30,column:20},end:{line:30,column:57}}}))?o:"")+'meta-field edit-meta-field edit-photo-desc" wrap="on"></textarea>\n\t\t\t<textarea class="'+(null!=(o=r(e,"if").call(i,null!=l?r(l,"isMobile"):l,{name:"if",hash:{},fn:n.program(16,a,0),inverse:n.noop,data:a,loc:{start:{line:31,column:20},end:{line:31,column:57}}}))?o:"")+'meta-field edit-meta-field false-textarea false-edit-photo-desc" wrap="on" tabindex="-1" aria-hidden="true"></textarea>\n'},19:function(n,l,e,t,a){var o=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t\t\t\t"+n.escapeExpression((o(e,"photoDescription")||l&&o(l,"photoDescription")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},null!=l?o(l,"description"):l,0,null!=l?o(l,"isFlickrOnFlickr"):l,{name:"photoDescription",hash:{},data:a,loc:{start:{line:26,column:5},end:{line:26,column:56}}}))+"\n"},21:function(n,l,e,t,a){var o,i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return"\t\t"+(null!=(o=i(e,"unless").call(null!=l?l:n.nullContext||{},null!=(o=null!=l?i(l,"empty"):l)?i(o,"desc"):o,{name:"unless",hash:{},fn:n.program(22,a,0),inverse:n.noop,data:a,loc:{start:{line:39,column:2},end:{line:41,column:13}}}))?o:"")},22:function(n,l,e,t,a){var o=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'">\n\t\t\t<span class="title-desc-more-button">'+n.escapeExpression((o(e,"intlMessage")||l&&o(l,"intlMessage")||n.hooks.helperMissing).call(null!=l?l:n.nullContext||{},{name:"intlMessage",hash:{intlName:"common.MORE"},data:a,loc:{start:{line:40,column:40},end:{line:40,column:78}}}))+"</span>\n"},compiler:[8,">= 4.3.0"],main:function(n,l,e,t,a){var o,i=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return null!=(o=i(e,"unless").call(null!=l?l:n.nullContext||{},null!=l?i(l,"noContentToDisplay"):l,{name:"unless",hash:{},fn:n.program(1,a,0),inverse:n.noop,data:a,loc:{start:{line:1,column:0},end:{line:44,column:11}}}))?o:""},useData:!0}),t={};n.Array.each([],(function(l){var e=n.Template.get("hermes/"+l);e&&(t[l]=e)})),n.Template.register("hermes/sub-photo-title-desc",(function(l,a){return(a=a||{}).partials=a.partials?n.merge(t,a.partials):t,e(l,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});